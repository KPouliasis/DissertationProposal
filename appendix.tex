\chapter{Theorems}

\begin{theorem}[Deduction Theorem for Validity Judgments]
	\label{deduct}
With $\Delta\vdash \llbracket\sf wf\rrbracket$, if $\Delta, s:\llbracket   A\rrbracket \vdash\llbracket B \rrbracket $ then $\Delta \vdash\llbracket   A \supset B \rrbracket $. 
\end{theorem}
\begin{proof}
The proof is essentially the deduction theorem for a Hilbert style formulation of the corresponding fragment of  propositional logic and we do not show it here for economy. Note that this theorem cannot be proven without the logical specification {\sf $Ax_1$, $Ax_2$}. I.e. it is exactly the requirements of the logical specification that ensure that all  interpretations  should adequately embed intuitionistic implication.
\end{proof}
\begin{lemma}[$\llbracket\cdot\rrbracket$Lifting Lemma]
\label{bracklift}
Given any wellformed context of assumptions $\Gamma \vdash {\sf wf}$ and $\Gamma,  A \in {\sf Prop_0}$ then $\Gamma\vdash   A \Longrightarrow \llbracket \Gamma\rrbracket \vdash \llbracket   A \rrbracket$. 
\end{lemma}

\begin{proof}
The proof goes by induction on the derivations trivially for all the cases($\supset_E$ is treated using the ${\sf App}$ rule that internalizes Modus ponens). For the $\supset I$ the previous theorem has to be used.
\end{proof}
\begin{lemma}[$\Box$Lifting Lemma]
\label{boxlift}
For $\Gamma,   A \in {\sf Prop_0}$, then $\Gamma\vdash   A$ implies $\Box\Gamma \vdash \Box   A$.
\end{lemma}
\begin{proof}
 Assuming a derivation $\mathcal {D}$ ::$\Gamma\vdash   A$, 
 from the  previous item, there exists corresponding validity derivation $\mathcal{E}::\llbracket\Gamma\rrbracket\vdash\llbracket   A \rrbracket$. Using the two as premises in the $\Box_{IE}$ with $\Gamma := \Box \Gamma$ we obtain $\Box\Gamma\vdash\Box   A$.
\end{proof}
Let us show an inverse principle to the $\Box$ Lifting Lemma. 
We define for $A$ in {\sf Prop$_1$}:
\begin{flalign*}
\nonumber  \downharpoonright (A_1\supset A_2)&  =  \downharpoonright A_1 \supset \downharpoonright A_2 \\
\downharpoonright \Box A & = \downharpoonright A
\end{flalign*}
And the lifting of the $\downharpoonright$ over $\Gamma\in {\sf Prop}$. We get:
\begin{theorem}[Collapse $\Box$ Lemma] If $\Gamma\vdash A$ for $\Gamma,A \in {\sf Prop_1}$ then $\downharpoonright \Gamma\vdash \downharpoonright$ A.
\end{theorem}
\begin{theorem}[Weakening]
For the N.D. system of Jcalc, with $\Gamma,\Gamma^{\prime}\vdash \sf wf$ and $\Delta,\Delta^{'}\vdash\llbracket {\sf wf}\rrbracket $.
\begin{enumerate}
\item If  $\Gamma\vdash   A$ then $\Gamma,\Gamma'\vdash   A$.
\item If  $\Delta\vdash \llbracket   A\rrbracket$ then $\Delta,\Delta^{'} \vdash \llbracket   A\rrbracket$.
\end{enumerate}

\end{theorem} 
\begin{proof}
By induction on derivations.
\end{proof}
\begin{theorem}[Contraction]
For the N.D. system of Jcalc, with $\Gamma,x:A,x':A,\Gamma'\vdash \sf wf$ and $\Delta,s:\llbracket A \rrbracket, s':\llbracket A\rrbracket,\Delta^{'}\vdash\llbracket {\sf wf}\rrbracket $.
\begin{enumerate}
\item If  $\Gamma,x:A,x':A,\Gamma'\vdash  B$ then $\Gamma,x:A,\Gamma'\vdash   B$.
\item If  $\Delta,s:\llbracket A \rrbracket, s':\llbracket A\rrbracket,\Delta^{'}\vdash\llbracket B \rrbracket $ then $\Delta,s:\llbracket A \rrbracket, \Delta^{'} \vdash \llbracket   B\rrbracket$.
\end{enumerate}  
\end{theorem}
\begin{proof}
By induction on derivations.
\end{proof}
\begin{theorem}[Permutation]
For the N.D. system of Jcalc, with $\Gamma\vdash \sf wf$ and $\Delta\vdash\llbracket {\sf wf}\rrbracket $ and $\pi \Gamma$ and $\pi \Delta$ the collection of well-formed contexts of assumptions with the same co-domain of $\Gamma$, $\Delta$ we get
\begin{enumerate}
\item If  $\Gamma\vdash   A$ and $\Gamma'\in \pi{\Gamma}$ then $\Gamma'\vdash   A$.
\item If  $\Delta\vdash \llbracket   A\rrbracket$ and $\Delta^{'}\in \pi \Delta$ then  $ \Delta'\vdash \llbracket   A\rrbracket$.
\end{enumerate}
\end{theorem}
\begin{proof}
By induction on derivations.
\end{proof}
\begin{theorem}[Substitution Principle]
The following hold for both kinds of judgments:
\begin{enumerate}
\item If  $\Gamma,x:A\vdash B$ and $\Gamma\vdash  A$ then $\Gamma\vdash B$ 
\item If  $\Delta,s:\llbracket A \rrbracket \vdash \llbracket B\rrbracket$ and$\Delta\vdash  \llbracket A\rrbracket$ then  $\Delta\vdash\llbracket B\rrbracket$ 
\end{enumerate}
\end{theorem}
All previous  theorems can be stated for proof terms too. Specifically:
\begin{theorem}[Deduction Theorem / Emulation of $\lambda$ abstraction]
	\label{deductterms}
	With $\Delta\vdash \llbracket\sf wf\rrbracket$, if $\Delta, s:\llbracket   A\rrbracket \vdash {\sf j}:\llbracket B \rrbracket $ then there exists {\sf j'} s.t. $\Delta \vdash {\sf j'}:\llbracket   A \supset B \rrbracket $. 
\end{theorem}
\begin{lemma}[$\llbracket\cdot\rrbracket$Lifting Lemma for terms]
\label{highorder}
	If $\Gamma A \in {\sf Prop_0}$ and $\Gamma\vdash M: A$ then there exists ${\sf j}$ s.t. $\llbracket \Gamma\rrbracket \vdash {\sf j}:\llbracket   A \rrbracket$. 
\end{lemma}
In both theorems the existence of this ${\sf j,j'}$ is algorithmic following the induction
principle of the proof. 


\chapter{Notes on the cut elimination proof and normalization of natural deduction}
\label{norm}
Standardly, we add the bottom type and elimination rule in the natural deduction and show that in Jcalc + $\bot$: $\centernot\vdash\bot$. The addition goes as follows:

\begin{mathpar}
\inferrule*[right= Bot] { } {\bot \in {\sf Prop_0}}	
\and
\inferrule*[right= $E_\bot$] {{\Gamma\vdash\bot }\\ A\in {\sf Prop}} {\Gamma \vdash A}
\end{mathpar}
Our proof strategy follows directly \cite{pfenning2004automated}. 
We construct an intercalation calculus \cite{Sieg1998} corresponding to the ${\sf Prop}$ fragment  with the following two judgments:
\begin{itemize}
	\item[] $A\Uparrow$ for ``Proposition $A$ has normal deduction".
	\item[] $A^\downarrow$ for ``Proposition $A$ is extracted from hypothesis".
\end{itemize}
This calculus is, essentially, restricting the natural deduction to canonical derivations. The $\llbracket {\sf judgments} \rrbracket$ are not annotated and are directly ported from the natural deduction since we observe consistency in ${\sf Prop}$. 
The construction is identical to \cite{pfenning2004automated} (Chapter 3) for the ${\sf Hypotheses},{\sf Coercion},\supset, \bot$ cases, we add the $\Box$ case.
\begin{mathpar}
	\inferrule*[right=$\Gamma$-hyp]  {x: A\downarrow \in \Gamma^\downarrow}{ \Gamma^\downarrow\vdash^{-} A\downarrow}
	\and
	\inferrule*[right=$\downarrow\Uparrow$] {\Gamma^\downarrow\vdash^{-} A\downarrow}{\Gamma^\downarrow\vdash^{-} A \Uparrow}
	\and
	\inferrule*[right=$\supset$I$^{x}$] {\Gamma^\downarrow, x: A\downarrow\vdash^{-}  B\Uparrow} {\Gamma^\downarrow \vdash^{-}  A\supset  B\Uparrow}
	\inferrule*[right=$\supset$E] {{\Gamma^\downarrow\vdash^{-} A\supset  B \downarrow}\\{\Gamma^\downarrow\vdash^{-}  A\Uparrow}} {\Gamma^\downarrow\vdash^{-}   B\downarrow}
	%\and
	%\inferrule*[right=$\bot$E] {{\Turn {\Gamma} {\bot}}}{\Turn {\Gamma} {   A}}
\and
\inferrule*[right= $E_\bot$] {{\Gamma^{\downarrow}\vdash^{-}\bot\downarrow }\\ A\in {\sf Prop}} {\Gamma^{\downarrow}\vdash^{-} A\Uparrow}
\and
 	\inferrule*[right=$\Box_{IE}$ ] {{\Gamma\downarrow\vdash A\Uparrow }\\ {\llbracket \Gamma \rrbracket\vdash \llbracket A \rrbracket}}{ {\Box\Gamma\downarrow\vdash \Box A\Uparrow }}
 \end{mathpar}
We prove simultaneously by induction:
\begin{theorem}[Soundness of Normal Deductions]
The following hold:
\begin{enumerate}
\item If $\Gamma^\downarrow\vdash^{-} A\Uparrow$ then $\Gamma\vdash A$, and
\item If $\Gamma^\downarrow\vdash^{-} A\downarrow $ then $\Gamma\vdash A$.
\end{enumerate}
\end{theorem}
\begin{proof}
	Simultaneously by induction on derivations.
\end{proof}
It is easy to see that this restricted proof system $\centernot\vdash^{-} \bot\Uparrow$. It is hard to show its completeness to the non-restricted natural deduction ($\vdash + \bot_E$ of Jcalc) directly. For that reason we add a rule to make it complete ($\vdash^{+}$) preserving soundness and get a system of Annotated Deductions. We show the correspondence of the restricted system ($\vdash^{-}$) to a cut-free sequent calculus (${\sf JSeq}$), the correspondence of the extended system ($\vdash^{+}$) to ${\sf Jseq + Cut}$ and show cut elimination.\footnote{ In reality, the sequent calculus formulation is built exactly upon intuitions on the intercalation calculus. We refer the reader to the references.}

To obtain completeness we add the rule:
 \begin{mathpar}
 	\inferrule*[right=$\Uparrow\downarrow$] {\Gamma^\downarrow\vdash A\Uparrow} {\Gamma^\downarrow\vdash A\downarrow }
 \end{mathpar}
We define $\vdash^{+} :=\   \ \ \vdash^{-} {\sf with} {\ \sf \Uparrow\downarrow}{\sf Rule}$.
We show:
\begin{theorem}[Soundness of Annotated Deductions]
	The following hold:
	\begin{enumerate}
		\item If $\Gamma^\downarrow\vdash^{+} A\Uparrow$ then $\Gamma\vdash A$, and
		\item If $\Gamma^\downarrow\vdash^{+} A\downarrow $ then $\Gamma\vdash A$.
	\end{enumerate}
\end{theorem}
\begin{proof}
	As previous item.
\end{proof}

\begin{theorem}[Completeness of Annotated Deductions]
	\label{compannot}
	The following hold:
	\begin{enumerate}
		\item If $\Gamma\vdash A$ then, $\Gamma\downarrow\vdash^{+} A\Uparrow$, and
		\item If $\Gamma\vdash A$, then $\Gamma\downarrow\vdash^{+} A\downarrow$.
	\end{enumerate}
\end{theorem}
\begin{proof}
	By induction over the structure of the $\Gamma\vdash A$ derivation.
\end{proof}

Next we move with devising a sequent calculus formulation corresponding to normal proofs $\Gamma^{\downarrow}\vdash^{-}A\Uparrow$. The calculus that is given in the main body of this theorem. We repeat it here for completeness.
\begin{mdframed}[nobreak=true,frametitle={\footnotesize Sequent Calculus ($\llbracket {\sf Prop_0} \rrbracket$)}]
	$$\begin{array}{l r}
	\Delta \Rightarrow \llbracket A\rrbracket:= & \exists \Delta'\in \pi(\Delta)\ \text{s.t} \   
	\Delta'\vdash \llbracket A \rrbracket \end{array}$$
	where $\pi(\Delta)$ is the collection of wellformed  $\llbracket {\sf Prop_0} \rrbracket$ contexts $\Delta'\vdash \llbracket {\sf wf}\rrbracket$  with some permutation of the multiset $\Delta$ as co-domain.
\end{mdframed} 


\begin{mdframed}[nobreak=true,frametitle={\footnotesize Sequent Calculus ({\sf Prop})}]
	\mbox{\small
		\begin{mathpar}
			\inferrule*[right=$Id$] { }{\Gamma, A  \Rightarrow A }
			
			\inferrule*[right=$\supset_L$] {{\Gamma, A\supset B, B \Rightarrow  C }\\ {\Gamma, A\supset B \Rightarrow A}} {\Gamma, A\supset B \Rightarrow  C}
			\and
			\inferrule*[right=$\supset_R$] {\Gamma, A \Rightarrow  B} {\Gamma \Rightarrow A\supset B}
			\and
			\inferrule*[right=$\bot_L$] { } {\Gamma, \bot \Rightarrow A}
			\and
			\inferrule*[right=$\Box_{LR}$] {{\Gamma\Rightarrow A}\\{\llbracket\Gamma\rrbracket\Rightarrow \llbracket A \rrbracket }}{\Box\Gamma\Rightarrow \Box A}
			%\inferrule*[right=$\supset$E] {{\Turn {\Gamma} { A\supset  B}}\\{\Turn {\Gamma} { A}}} {\Turn {\Gamma} {   B}}
			%\and
			%\inferrule*[right=$\bot$E] {{\Turn {\Gamma} {\bot}}}{\Turn {\Gamma} {   A}}
		\end{mathpar}}
		%Where the  rule $\Box_{LR}$corresponds to $\Box_{IE}$ and relates the two kinds of sequents 
	\end{mdframed}
We want to show correspondence of the sequent calculus  w.r.t normal proofs ($\vdash^{-}$).  Two lemmas are required to show soundness. 
\begin{lemma}[Substitution principle for extractions]
The following hold:
\begin{enumerate}
\item If $\Gamma_1^\downarrow, x:A^\downarrow,\Gamma_2^\downarrow\vdash^{-} B\Uparrow$ and\\$\Gamma_1^\downarrow\vdash^{-} A\Uparrow$ then  $\Gamma_1^\downarrow,\Gamma_2^\downarrow\vdash^{-} B\Uparrow$
\item  If $\Gamma_1^\downarrow, x:A^\downarrow,\Gamma_2^\downarrow\vdash^{-} B\downarrow$ and $\Gamma_1^\downarrow\vdash^{-} A\downarrow$ then $\Gamma_1^\downarrow,\Gamma_2^\downarrow\vdash^{-} B\Uparrow$    
\end{enumerate}
\end{lemma}
\begin{proof}
Simultaneously by induction on the derivations $A\downarrow$ and $A\Uparrow$.
\end{proof}
And making use of the previous we can show, with ($\downharpoonright A$ defined previously):
\begin{lemma}[Collapse principle for normal deductions]
The following hold:
\begin{enumerate}
		\item If $\Gamma^\downarrow,\vdash^{-}  A\Uparrow$ then $\downharpoonright\Gamma^\downarrow\vdash^{-} \downharpoonright A\Uparrow$   and,
		\item If $\Gamma^\downarrow\vdash^{-} A\downarrow$ then  $\downharpoonright\Gamma^\downarrow\vdash^{-} \downharpoonright A\downarrow$   
	\end{enumerate}
\end{lemma}
Using the previous lemmas and by induction we can show :
\begin{theorem}[Soundness of the Sequent Calculus] 
	\label{soundnseq}
If   $\Gamma\Rightarrow B$ then $\Gamma^\downarrow\vdash^{-} B\Uparrow$.

	
\end{theorem}
\begin{theorem}[Soundness of the Sequent Calculus with Cut] 
	
	If   $\Gamma\Rightarrow^{+} B$ then $\Gamma^\downarrow\vdash^{+} B\Uparrow$.
\end{theorem}

Next we define the $\Gamma\Rightarrow^{+} A$ as $\Gamma\Rightarrow A$ plus the rule:
\begin{mathpar}
\inferrule*[right=Cut]{{\Gamma\Rightarrow^{+} A}\\{\Gamma,A\Rightarrow^{+}B}}{\Gamma\Rightarrow^{+}B}
\end{mathpar}
\begin{proof}
As before. The cut rule case is handled by the $\Uparrow\downarrow$ and substitution for extractions principle showcasing  the correspondence of the cut rule to the coercion from normal to extraction derivations.
\end{proof}
Standard structural properties (\textit{Weakening, Contraction}) to show completeness. We do not show these here but they hold.
\begin{theorem}[Completeness of the Sequent Calculus] 
	\label{compseqcalc}
	The following hold:
	\begin{enumerate}
		\item If   $\Gamma^\downarrow\vdash^{-} B\Uparrow$ then $\Gamma\Rightarrow B$ and,
		\item 	If $\Gamma^\downarrow \vdash^{-} A\downarrow$ and $\Gamma,A\Rightarrow B$ then $\Gamma\Rightarrow B$   
	\end{enumerate}
\begin{proof}
	Simultaneously by induction on the given derivations making use of the structural properties.
\end{proof}
Similarly we show for the extended systems.
\begin{theorem}[Completeness of the Sequent Calculus with Cut] The following hold:
	\label{compseqcut}
	\begin{enumerate}
		\item If   $\Gamma^\downarrow\vdash^{+} B\Uparrow$ then  $\Gamma\Rightarrow^{+} B$ and,
		\item 	If $\Gamma^\downarrow \vdash^{+} A\downarrow$ and $\Gamma,A\Rightarrow^{+} B$ then $\Gamma\Rightarrow^{+} B$.   
	\end{enumerate}
\end{theorem}
\begin{proof}
	As before. The extra case is handled by the Cut rule.
\end{proof}
\end{theorem}
After establishing the correspondence of $\vdash^{-}$ with $\Rightarrow$ and of $\vdash^{+}$ with $\Rightarrow^{+}$ we move on with:
\begin{theorem}[Admissibility of Cut]
	If $\Gamma\Rightarrow A$ and $\Gamma,A\Rightarrow B$ then $\Gamma\Rightarrow B$.
\end{theorem}
The proof is by double induction on the structure of the formula, its (sub-)derivations. This gives easily:
\begin{theorem}[Cut Elimination]
	If $\Gamma\Rightarrow^{+}A$ then $\Gamma\Rightarrow A$.
	
\end{theorem}
Which in turn gives us:
\begin{theorem}[Normalization for Natural Deduction]
	\label{normalization}
	If $\Gamma\vdash A$ then $\Gamma^{\downarrow}\vdash^{-} A\Uparrow$
\end{theorem}
\begin{proof}
	From assumption $\Gamma \vdash A$ which by completeness of annotated deductions gives $\Gamma\vdash^{+} A\Uparrow$. 
	Then by completeness of sequent calculus  and Cut  Elimination we obtain $\Gamma\Rightarrow A$ 
	which by  soundness of sequent calculus completes the proof.
\end{proof}
As a result we obtain:
\begin{proof}
	By contradiction, assume $\vdash\bot$ then $\Rightarrow \bot$ which is not possible.
\end{proof}
\chapter{Makam Implementation}
A \textit{Github} repository \cite{jcalcrepo} is preserved for $Jcalc$, which includes an implementation in the
metaprogramming framework {\sf Makam} ~\cite{stampoulis}. 
The implementation is currently developed by Antonis Stampoulis and
the author. A type checker for $Jcalc$ terms has been implemented and the call-by-value evaluation
strategy is under current development. 

The interested reader should install {\sf Makam}
(in a unix environment) and then  can run the executable \url{run.sh} 
file included in the repository. 
A successful run will verify a number of $Jcalc$  theorems encoded in the file \url{just.md} 
and will  additionally output an html file 
(already included in the repository as \url{just.html}).
The obtained file is a notebook of (pretty-printed) {\sf Latex} and {\sf Makam} code 
that can be opened in any modern browser.
It showcases how the implementation faithfully follows the rules 
of the formal system.  